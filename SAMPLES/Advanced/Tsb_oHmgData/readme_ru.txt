MINIGUI - Harbour Win32 GUI library Demo
Copyright 2024 Sergej Kiselev <bilance@bilance.lv>
Copyright 2024 Verchenko Andrey <verchenkoag@gmail.com> Dmitrov, Moscow region
--------------------------------------------------------------------------------------------------------------------

Три примера работы с объектом Tsbrowse (ТСБ): 
1) demo.prg  - на базе функции _TBrowse(...) с использованием oHmgData()
2) demo1.prg - на базе функции _TBrowse(...) сокращённый вариант и другой вариант правки колонок
3) demo2.prg - с помощью обычных функций и oHmgData()
--------------------------------------------------------------------------------------------------------------------
* Тестирование колонок в Tsbrowse для dbf файла
* Ввод в таблицу. Проверка до и после ввода.
* Итоги по числовым полям, автоматический пересчёт при изменении данных в колонке
* Своё окно редактирования мемо-поля и текстовых колонок с CRLF
* Отработка клика мышки (правая/левая) на суперхидере/шапке/подвале/ячейки таблицы
* Работа со SCOPE.
* Сохранение/восстановление размеров окна в ини-файл.
* Работа с буфером обмена: копирование/вставка ячеек таблицы разного формата
* Построение справочника ввода документов по месяцам года - demo2_menu_Fxx.prg
* Построение отчёта справочника ввода документов/поиск по буквам и подсчёт итогов "на лету" - demo2_menu2_1find.prg
                                                                                            - demo_menu_find.prg
--------------------------------------------------------------------------------------------------------------------
Реализация построения итогов в подвале таблицы:
   Делаем первоначальнй расчёт по базе по числовым колонкам ( o:Event({2, "_ItogGet"}..... )
   Сохраняем сумму колонки в oCol:Cargo:nTotal  
   Изменение данных в колонке - делается пересчёт по колонке, добавляется/вычитается ТОЛЬКО это число:
       ? ":bPostEdit  ,oc:Cargo:lTotal=",oc:Cargo:lTotal, "oc:xOldEditValue=",oc:xOldEditValue
       lSay := .F.
       IF oc:Cargo:lTotal .and. oc:xOldEditValue != uVal
          oc:Cargo:nTotal += uVal - oc:xOldEditValue
          lSay := .T.
       ENDIF
       ?? "oc:Cargo:nTotal=",oc:Cargo:nTotal
       // послать сообщение на перепоказ ИТОГО в колонках
       IF lSay ; _wPost("_ItogSay", ob:cParentWnd)  
       ENDIF
--------------------------------------------------------------------------------------------------------------------
Для смены языка в программе на английский сделаете так в начале кода программы:
    #define LANG_PRG "EN"  // "EN" English interface-lang
--------------------------------------------------------------------------------------------------------------------
Задание параметров таблицы в списке колонок - Column_TSB()  
   //       Резерв|Edit| тип | название колонок| поле бд/функц.| ширина поля  | формат поля |блок кода|*F функция1  |**F функция2
   aDim[1] := { 1 , "R","BMP", "*"             , "PUSTO"       , "XXX"        , "999"       , "bKey01","внутри кода", nil           }
   aDim[2] := { 1 , "W", "D" , "Дата;оплаты"   , "PRIDAT"      , "99099099000", "99.99.99"  , nil     , nil         , "CheckDate()" } // проверка после ввода
   aDim[3] := { 1 , "W", "N" , "Сумма;(руб.)"  , "PRIXOD"      , REPL("9",12) , "999 999.99", nil     , nil         , nil           }
   aDim[4] := { 1 , "W", "C" , "Л/с;абонента"  , "RC_ABON"     , REPL("9",11) , REPL("x",8) , nil     , nil         , "SeekAbonRc()"} // поиск после ввода
--------------------------------------------------------------------------------------------------------------------
* Задание своих размеров окна программы, позволяет протестировать на другие разрешения экрана
o:aDisplayMode   := { 1280 , 1080 }    <<--- менять здесь
o:cDisplayMode   := HB_NtoS(o:aDisplayMode[1]) + "x" + HB_NtoS(o:aDisplayMode[2])
--------------------------------------------------------------------------------------------------------------------
Смена текста на кнопках верхнего меню:
  demo2_menu.prg
  oMenu:lTextLeft  := .T.  // .T.-слева текст для кнопок, .F.-справа
  oMenu:lTextVert  := .F.  // .T.-вертикальный текст для кнопок, .F.- НЕ вертикальный текст
--------------------------------------------------------------------------------------------------------------------
Смена вывода кнопок и текста на кнопках - demo2_menu2_1find.prg
   myTopMenu( nY, nX, nG, nHIco )
   ........
   nHAlign := DT_CENTER   // горизонтальные кнопки: 0-DT_LEFT, 1-DT_CENTER, 2-DT_RIGHT
   lVert   := .F.         // .T.-вертикальный текст для кнопок, .F.- НЕ вертикальный текст
   lLeft   := .F.         // .T.-слева текст для кнопок, .F.-справа
--------------------------------------------------------------------------------------------------------------------
Не реализованы режимы меню:
   oMenu:nPosWin := XX         // 3-LeftWindow, 4-RightWindow

 